<main class="row">
  <div class="col-12 calendar-page-body">
    <%= SimpleCalendar::ScheduleCalendar.new(self, {events: @schedules, attribute: :work_on}).render do |date, schedules| %>
      <%= date.strftime('%-m/%-d') %>
      <% schedules.each do |schedule| %>
        <% if schedule.present? %>
          <div class="shift-selector-wrapper">
            <%= form_with model: schedule do |f| %>
              <%= f.select :shift, {'隔勤': 0, '日勤': 1, '夜勤': 2}, { selected: Schedule.shifts[schedule.shift] }, class: [schedule.work_on, 'shift-selector'] %>
            <% end %>
          </div>
        <% end %>
      <% end %>
    <% end %>
  </div>

  <div class="col-12 shift-form">
    <%= form_with url: schedules_path, class: 'schedule-form' do |f| %>
      <%= hidden_field_tag :start_date, @start_date %>
      <% @schedules.each do |schedule| %>
        <%= f.hidden_field "schedules[][work_on]", value: schedule.work_on, class: [schedule.work_on, 'work-on']  %>
        <%= f.hidden_field "schedules[][shift]", value: Schedule.shifts[schedule.shift], class: [schedule.work_on, 'shift'] %>
      <% end %>
      <%= f.submit nil, class: 'btn btn-primary' %>
    <% end %>
  </div>

  <div class="col-12">
    <p class="work-count"><%= @schedules.count_work_days %> 出番</p>
  </div>
</main>

<%= javascript_pack_tag 'schedules/new_pack' %>
